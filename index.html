<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="ghost">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="ghost">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ghost">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>ghost</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ghost</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/24/Elastic-Stack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fireworks">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ghost">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/24/Elastic-Stack/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-24T20:04:32+08:00">
                2018-04-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Elastic-Stack概述"><a href="#Elastic-Stack概述" class="headerlink" title="Elastic Stack概述"></a>Elastic Stack概述</h3><ul>
<li>elasticsearch是数据存储,查询与分析</li>
<li>kibana是数据探索与可视化分析</li>
<li>Beats,Logstash是数据收集与处理<h4 id="elasticsearch"><a href="#elasticsearch" class="headerlink" title="elasticsearch"></a>elasticsearch</h4></li>
<li><p>安装elasticsearch<br>进入<a href="https://www.elastic.co/cn/" target="_blank" rel="noopener">elasticsearch官网</a>,下载对应自己电脑型号和版本的压缩包,解压,进入bin目录,执行elasticsearch,启动elasticsearch</p>
</li>
<li><p>elasticsearch配置说明<br>1).cluster.name集群名称,以此作为是否同一集群的判断条件<br>2).node.name节点名称,以此作为集群中不同节点的区分条件<br>3).network.host/http.port网络地址和端口,用于http和transport服务使用<br>4).path.data数据存储地址<br>5).path.log日志存储地址</p>
</li>
<li><p>elasticsearch本地启动集群的方式<br>1).bin/elasticsearch<br>2).bin/elasticsearch -Ehttp.port=8200 -Epath.data=node2</p>
</li>
</ul>
<ol start="3">
<li>bin/elasticsearch -Ehttp.port=7200 -Epath.data=node3</li>
</ol>
<ul>
<li><p>如何验证三个节点组成一个集群<br>在浏览器上输入<a href="http://127.0.0.1:7200/_cat/nodes" target="_blank" rel="noopener">http://127.0.0.1:7200/_cat/nodes</a>,<br>就会展示<br>127.0.0.1 27 58 8    mdi - ZSq9WKC<br>127.0.0.1 28 58 6    mdi - V8BTpaW<br>127.0.0.1 29 58 8    mdi * Z_C-ibU<br>如果出现就证明成功</p>
</li>
<li><p>如何判断哪个是主节点,哪个是从节点<br>在浏览器上输入<a href="http://127.0.0.1:7200/_cat/nodes?v" target="_blank" rel="noopener">http://127.0.0.1:7200/_cat/nodes?v</a><br>然后出来<br>ip        heap.percent ram.percent cpu load_1m load_5m load_15m node.role master name<br>127.0.0.1   28    42  13              mdi       -      ZSq9WKC<br>127.0.0.1   28    42  13              mdi       -      V8BTpaW<br>127.0.0.1   29    42  13              mdi       <em>      Z_C-ibU<br>注:</em>代表主节点</p>
</li>
<li><p>如何查看集群的状态消息<br>在浏览器上输入<br><a href="http://127.0.0.1:7200/_cluster/stats" target="_blank" rel="noopener">http://127.0.0.1:7200/_cluster/stats</a></p>
</li>
<li>常用术语<br>1).Document文档数据<br>2).Index索引<br>3).Type索引中的数据类型<br>4).Field字段,文档的属性<br>5).Query DSL查询语法<h4 id="kibana"><a href="#kibana" class="headerlink" title="kibana"></a>kibana</h4></li>
<li>下载kibana<br>进入<a href="https://www.elastic.co/cn/" target="_blank" rel="noopener">kibana官网</a>下载<br>进入kibana的bin目录下,执行kibana,就启动kibana了</li>
<li>kibana.yml关键配置说明<br>1).server.host/server.port访问kibana用的地址和端口<br>2).elasticsearch.url待访问elasticsearch的地址</li>
<li>kibana常用功能说明<br>1).Discover数据搜索查看<br>2).Visualize图表制作<br>3).Dashboard仪表盘制作<br>4).Timelion时序数据的高级可视化分析<br>5).DevTools开发者工具<br>6).Management配置<h4 id="beats"><a href="#beats" class="headerlink" title="beats"></a>beats</h4></li>
<li>轻量级的数据传送<br>1).Filebeat日志文件<br>2).Metricbeat 度量数据<br>3).Packetbeat 网络数据<br>4).Winlogbeat Windows数据<br>5).Heartbeat健康检查</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/22/云上快速搭建WordPress网站/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fireworks">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ghost">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/22/云上快速搭建WordPress网站/" itemprop="url">云上快速搭建WordPress网站</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-22T13:19:55+08:00">
                2018-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="关于LAMP"><a href="#关于LAMP" class="headerlink" title="关于LAMP"></a>关于LAMP</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;LAMP是指Linux(操作系统),Apache HTTP服务器,MySQL(有时也指MariaDB)数据库软件和PHP(有时也指Peri或Python)的首字母,一百用来建立web应用平台.和Java/J2EE架构相比,LAMP具有通用,跨平台,高性能,低价格的优势,因此LAMP无论是性能,质量还是价格都是企业搭建网站的首选平台.<br>&nbsp;&nbsp;&nbsp;&nbsp;Linux是一套免费使用和自由传播的类UNIX操作系统,目前运用最广泛使用人数最多的操作系统.<br>&nbsp;&nbsp;&nbsp;&nbsp;Apache是LAMP架构最核心Web Server,开源,稳定,模块丰富是Apache的优势,但Apache的缺点是有点臃肿,内存和CPU开销大,性能上有损耗,不如一些轻量级的Web服务器(例如ngnix)高效,轻量级的Web服务器对于静态文件的响应能力来说远高于Apache服务器.Apache做为Web Server是负载PHP的最佳选择,如果流量很大的话,可以采用ngnix来负载非PHP的Web请求.<br>&nbsp;&nbsp;&nbsp;&nbsp;PHP是一种通用开源脚本语言,语法吸收了C语言,Java和Perl的特点,利于学习,使用广泛,主要适用于Web开发领域,PHP独特的语法混合了C,Java,Perl以及PHP自创的语法,它可以比CGL或者Perl更快速地执行动态网页,用PHP做出的动态页面与其他的编程语言相比,PHP是将程序嵌入到HTML(标准通用标记语言下的一个应用)文档中去执行,执行效率比完全生成HTML标记的CGL要高出许多;PHP还可以执行编译后代码,编译可以达到加密和优化代码运行,使代码运行更快.<br>&nbsp;&nbsp;&nbsp;&nbsp;开源的数据库中,MySQL在性能,稳定性和功能上是首选,可以达到百万级别的数据存储,网站初期可以将MySQL和Web服务器放一起,但是当访问量达到一定规模后,应该将MySQL数据库从Web Server上独立出来,在单独的服务器上运行,同时保持Web Server和我MySQL服务器的稳定连接.  </p>
<h3 id="关于WordPress"><a href="#关于WordPress" class="headerlink" title="关于WordPress"></a>关于WordPress</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;WordPress是一种使用PHP语言开发的博客平台,用户可以在支持PHP和MySQL数据库的服务器上架构WordPress.可以使用WordPress搭建一个简单的独立博客,也可以把WordPress当作一个内容管理系统(CMS),用来搭建一个小门户网站,现在的WordPress已经强大到几乎可以搭建目前所有常见类型的网站,比如门户,下载站,淘宝客,论坛,多博客等等.</p>
<h2 id="关于CNZZ"><a href="#关于CNZZ" class="headerlink" title="关于CNZZ"></a>关于CNZZ</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;CNZZ是一个进行网页统计的平台,可以帮助站长收集网站上用户的浏览器分布,IP分布,流量等公开信息,方便网站管理,使得站长可以了解访问量变化,是不是被搜索引擎封杀等情况,及时作出应对.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/22/文件上传/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fireworks">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ghost">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/22/文件上传/" itemprop="url">文件上传</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-22T13:19:55+08:00">
                2018-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="文件上传概述"><a href="#文件上传概述" class="headerlink" title="文件上传概述"></a>文件上传概述</h3><p>1.文件上传是什么<br>&nbsp;&nbsp;&nbsp;&nbsp;在web开发中经常需要从客户端向服务器上传文件,如:上传照片,上传新闻图片,上传附件等等,这些都需要通过web开发中的文件上传技术实现.<br>2.文件上传步骤<br>&nbsp;&nbsp;&nbsp;&nbsp;实现wb开发中的文件上传功能只需要两个步骤:<br>&nbsp;&nbsp;&nbsp;&nbsp;(1).提供一个带有文件上传项的表单.<br>&nbsp;&nbsp;&nbsp;&nbsp;(2).在servlet中读取处理上传的文件,保存到服务器.</p>
<h3 id="文件上传实现"><a href="#文件上传实现" class="headerlink" title="文件上传实现"></a>文件上传实现</h3><p>1.在用户页面中添加上传输入项(客户端页面操作)<br><code>&lt;input type=&quot;file&quot; name=&quot;filex&quot;&gt;</code><br>&nbsp;&nbsp;&nbsp;&nbsp;注意事项:<br>&nbsp;&nbsp;&nbsp;&nbsp;(1).必须为文件上传input提供name属性,否则文件上传内容不会被表单提交.<br>&nbsp;&nbsp;&nbsp;&nbsp;(2).表单的提交方式必须为post(get提交数据在url地址上显示,有长度限制)<br>&nbsp;&nbsp;&nbsp;&nbsp;(3).表单必须设置enctype=multipart/form-data<br>2.在服务器端编写文件上传程序<br>&nbsp;&nbsp;&nbsp;&nbsp;通过Request对象提供一个getInputStream方法,可以读取到客户端提交过来的数据,但这种方式还需要对流中获取到的数据进行处理.<br>&nbsp;&nbsp;&nbsp;&nbsp;为了简化这个处理过程,Apache开源组织提供了一个用来处理表单文件上传的一个开源组件(Commons-fileupload),让开发人员轻松实现web文件上传功能.<br>3.上传组件(Apache commons-fileupload)使用过程<br>&nbsp;&nbsp;&nbsp;&nbsp;首先需要下载并导入该组件相关的支撑jar包:Commons-filesupload和commons-io,然后编程实现,步骤如下:<br>    (1)创建DiskFileItemFactory对象,设置缓冲区大小和临时文件目录</p>
<pre><code>public DiskFileItemFactory(int sizeThreshold,java.io.File repository) 
//构造工厂时,指定内存缓冲区大小和临时文件存放位置
public void setSizeThreshold(int sizeThreshold)
//设置内存缓冲区大小,默认10k
public void setRepository(java.io.File repository)
//设置临时文件存放位置,默认 System.getProperty(&quot;java.io.tmpdir&quot;)
*内存缓存区:上传文件时,上传文件的内容优先保存在内存缓冲区中,当
*上传文临时大小超过缓冲区大小,就会在服务器端产生临时文件
*临时文件存放位置:保存超过了内存缓冲区大小上传文件而产生临时文件
*产生临时文件可以通过FileItem的delete方法删除
</code></pre><p>(2).使用DiskFileItemFactory对象创建ServletFileUpload对象,并设置上传文件的大小限制.<br>(3).调用ServletFileUpload.parseRequest方法解析request对象,得到一个保存了所有上传FileItem的list集合  </p>
<pre><code>ServeltFIleUpload负责处理上传的文件数据,并将表单中每个输入项封装成一个FileItem对象中.常用的方法有:
//判断上传表单是否为multipart/form-data类型
boolean isMutipartContent(HttpServletRequest request)
//解析request对象,并把表单中的每一个输入项包装成fileItem对象,并返回一个保存了所有FileItem的list集合.
List parseRequest(HttpServletRequest request)
//设置单个上传文件的最大值
setFileSizeMax(long fileSizeMax)
//设置上传文件总量的最大值
setSizeMax(long sizeMax)
//解决上传文件名乱码问题
setHeadEncoding(java.lang.String encoding)
//实时监听文件上传状态
setProgressListener(ProgressListener pListener)
</code></pre><p>(4).对List进行迭代,每迭代一个FileItem对象,调用其isFormField方法判断是否上传文件.<br>&nbsp;&nbsp;&nbsp;&nbsp;True为普通表单字段,则调用getFieldName,getString方法得到字段名和字段值.<br>&nbsp;&nbsp;&nbsp;&nbsp;False为上传文件项,则调用getInputStream方法得到数据输入流,从而读取上传数据.<br>(5).如果是文件上传就通过流获取上传的数据保存到服务器中.  </p>
<pre><code>boolean idFormField()判断FileItem是一个文件上传对象还是普通字段项:
String getFieldName() 获得普通表单对象的name属性
String getString(String encoding)获得普通表单对象的value属性,可以用encoding进行编码设置
文件上传项:
String getName()获得上传文件的文件名(有些浏览器会携带客户端路径)
InputStream getInputStream()获得上传文件的输入流
delete() 在关闭FileItem输入流后,删除临时文件
</code></pre><h3 id="上传文件的监听"><a href="#上传文件的监听" class="headerlink" title="上传文件的监听"></a>上传文件的监听</h3><pre><code>//ServletFileUpload类提供了如下方法,监听文件上传时的进度信息:
pulbic void setProgressListener(ProgressListener pListener)
//设置监听器,文件上传程序会自动执行,监听器中update方法
public void update(long pBytesRead,long pContentLength,int pItems)
//在方法中可以获得文件总大小,已经上传大小和上传第几个元素
能否根据上面三个参数计算:剩余大小、传输速度、已用时间、剩余时间
(1).已用时间 = 当前时间 -开始时间
(2).速度 = 已经上传大小/已用时间
(3).剩余时间 = 总大小 - 已经上传大小
(4).剩余时间 = 剩余大小/速度
</code></pre><h3 id="上传文件注意问题"><a href="#上传文件注意问题" class="headerlink" title="上传文件注意问题"></a>上传文件注意问题</h3><p>1.文件保存位置<br>&nbsp;&nbsp;&nbsp;&nbsp;上传的文件如果直接存放在web应用根目录下,通过浏览器是可以直接访问的,如果用户上传一个JSP,再通过浏览器访问就可以通过文件上传在服务器执行任意的java代码,十分危险.<br>&nbsp;&nbsp;&nbsp;&nbsp;所以一定要注意,文件上传服务器保存文件的位置必须是WEB-INF目录下或服务器中浏览器无法访问的位置.<br>2.防止上传的文件重名覆盖<br>&nbsp;&nbsp;&nbsp;&nbsp;上传的文件如果重名,后上传的文件就会覆盖先上传文件.&nbsp;&nbsp;&nbsp;&nbsp;为了防止这样的问题产生,应该对文件名进行处理,可以在文件名钱拼接UUID,防止文件名重复.<br><code>filename = UUID.randomUUID().toString()+&quot;_&quot;+filename;</code><br>3.防止同一个目录下上传文件过多<br>&nbsp;&nbsp;&nbsp;&nbsp;一个目录下如果文件过多,必须会导致访问效率下降,所以我们需要将上传的文件进行分目录存储.<br>&nbsp;&nbsp;&nbsp;&nbsp;分目录存储的算法可以有很多:<br>&nbsp;&nbsp;&nbsp;&nbsp;(1).按照上传时间进行目录分离(周,月)<br>&nbsp;&nbsp;&nbsp;&nbsp;(2).按照上传用户进行目录分离—为每个用户建立单独目录<br>&nbsp;&nbsp;&nbsp;&nbsp;(3).按照固定数量进行目录分离–假设每个目录只能存在3000个文件后,创建一个新的目录<br>&nbsp;&nbsp;&nbsp;&nbsp;(4).按照唯一文件名的hashcode进行目录分离</p>
<pre><code>public static String generateRandomDir(String uui获dFileName){
//获得唯一文件名的hashcode
int hashcode = uuidFileName.hashCode();
//获得一级目录
int d1 = hashcode &amp; 0xf;
//获得二级目录
int d2 = (hashcode &gt;&gt;&gt; 4)&amp;0xf;
return &quot;/&quot;+ d2 + &quot;/&quot;+ d1;//共有256目录
}
</code></pre><p>4.文件上传代码</p>
<pre><code>1.创建一个UploadServlet类
try {
    response.setCharacterEncoding(&quot;utf-8&quot;);
    response.setContentType(&quot;text/html;charset=utf-8&quot;);

    //1.创建文件上传工厂
    DiskFileItemFactory factory = new DiskFileItemFactory(100, new File(this.getServletContext().getRealPath(&quot;WEB-INF/temp&quot;)));

    //2.创建文件上传的核心类
    ServletFileUpload fileUpload = new ServletFileUpload(factory);
    //--判断当前文件上传的表单是否满足enctype=multipart/form-data
    if(!fileUpload.isMultipartContent(request)){
        throw new RuntimeException(&quot;请使用正确的文件上传表单上传数据！&quot;);
    }
    //--设置文件名解析时采用的编码
    fileUpload.setHeaderEncoding(&quot;utf-8&quot;);
    //--单个文件不能超过1MB
    fileUpload.setFileSizeMax(1024 * 1024);
    //--总大小不能超过10MB
    fileUpload.setSizeMax(10 * 1024 * 1024);
    //--设置上传文件的监听
    fileUpload.setProgressListener(new ProgressListener(){
        long begin = System.currentTimeMillis();
        public void update(long pBytesRead, long pContentLength,int pItems) {
    System.out.print(&quot;正在读取第&quot;+pItems+&quot;个上传项。。&quot;);
        System.out.print(&quot;共&quot;+pContentLength+&quot;字节。。&quot;);
        System.out.print(&quot;已经读取了&quot;+pBytesRead+&quot;字节。。&quot;);

        long leftBytes = pContentLength - pBytesRead;
        System.out.print(&quot;剩余&quot;+leftBytes+&quot;字节。。&quot;);

        long now = System.currentTimeMillis();
        long usetime = (now - begin)/1000 ;
        System.out.print(&quot;已经用时&quot; + usetime+&quot;秒。。&quot;);

        long speed = usetime == 0 ? 0 : pBytesRead / usetime / 1024;
        System.out.print(&quot;上传速度&quot; + speed+&quot;KB/s。。&quot;);

        double per = Math.round(pBytesRead * 10000.0 / pContentLength)/100.0;
        System.out.println(&quot;上传百分比&quot; + per + &quot;%。。&quot;);

        long lefttime = speed == 0 ? 0 : leftBytes /1024 / speed;
        System.out.println(&quot;大致剩余时间&quot;+lefttime+&quot;秒&quot;);

        request.getSession().setAttribute(&quot;progress&quot;, per);
        }

        });

    //--解析request得到FileItem的集合
    List&lt;FileItem&gt; items = fileUpload.parseRequest(request);

    //--遍历每个item分别做处理
    for(FileItem item : items){
        if(item.isFormField()){
            //普通字段项
            String name = item.getFieldName();
            String value = item.getString(&quot;utf-8&quot;);
            System.out.println(name+&quot;~&quot;+value);
        }else{
            //文件上传项
            String fname = item.getName();
            //--处理ie文件名bug
            if(fname.contains(&quot;\\&quot;)){
                fname = fname.substring(fname.lastIndexOf(&quot;\\&quot;)+1);
            }

            //--处理文件名 使其不会重复
            String savename = UUID.randomUUID().toString()+&quot;_&quot;+fname;

            //--文件分目录处理
            //----获取文件名的hash 转换为16进制字符串表现形式 由于文件名随机 所以 hash值也是散列的
            String hash = Integer.toHexString(savename.hashCode());

            //----如果hash不足8位则在前面拼接足够8位的0
            while(hash.length()&lt;8){
                hash += &quot;0&quot;;
            }
            //----遍历hash值字符串的每一个字符作为一级目录拼接
            String savepath = &quot;/WEB-INF/upload/&quot;;
            for(int i = 0;i&lt;hash.length();i++){
                savepath += (hash.charAt(i)+&quot;/&quot;);
            }
            //----创建出该目录
            new File(this.getServletContext().getRealPath(savepath)).mkdirs();

            //----得到输入流
            InputStream in = item.getInputStream();

            //----得到输出流 路径就是上面 hash拼接出的路径+文件名
            OutputStream out = new FileOutputStream(this.getServletContext().getRealPath(savepath + &quot;/&quot; +savename));

            //----输出数据到文件
            byte []  data = new byte[1024];
            int n = -1;
            while((n = in.read(data))!=-1){
                out.write(data,0,n);
            }

            //----关闭流
            in.close();
            out.close();

            //----删除缓存文件
            item.delete();
        }
    }

    } catch (FileSizeLimitExceededException e) {
        response.getWriter().write(&quot;文件大小超过限制！！&quot;);
    } catch (Exception e) {
        throw new RuntimeException(e);
    }
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/22/事务/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fireworks">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ghost">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/22/事务/" itemprop="url">事务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-22T13:19:55+08:00">
                2018-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="事务的概念"><a href="#事务的概念" class="headerlink" title="事务的概念"></a>事务的概念</h3><p>事务指逻辑上的一组操作,组成这组操作的各个单元,要么全部成功,要么全部不成功.  </p>
<h3 id="管理事务"><a href="#管理事务" class="headerlink" title="管理事务"></a>管理事务</h3><p>1.数据库默认的事务<br>&nbsp;&nbsp;&nbsp;&nbsp;数据库默认支持事务的,但是数据库默认的事务是一条sql语句独占一个事务,这种模式,意义不大.<br>2.手动控制事务<br>&nbsp;&nbsp;&nbsp;&nbsp;如果希望自己控制事务也是可以的:</p>
<pre><code>start transaction;
---开启事务,在这条语句之后的所有的sql将处在同一个事务中,要么同时完成要么同时不完成.
.......
--事务中的sql在执行时,并没有真正修改数据库中的数据
commit;
--提交事务,将整个事务对数据库的影响一起发生
rollback;
--回滚事务,将这个事务对数据库的影响取消掉
</code></pre><p>3.JDBC中控制事务<br>&nbsp;&nbsp;&nbsp;&nbsp;当jdbc程序数据库获得一个Connection对象时,默认情况下这个Connection对象会自动向数据库提交在它上面发送的SQL语句,若想关闭这种默认提交方式,让多条SQL在一个事务中执行,可使用下列语句:</p>
<pre><code>conn.setAutoCommit(false);
--关闭自动连接后,conn将不会帮我们提交事务,在这个连接上执行所有的sql语句将处在同一个事务中,需要我们是手动的进行提交或回滚.
conn.commit();
--提交事务
conn.rollback();
--回滚事务
也可以设置回滚点回滚部分事务
SavePoint sp = conn.setSavePoint();
conn.rolback(sp);
--注意,回到回滚点后,回滚点之前的代码虽然没被回滚但是也没被提交,如果想起作用还要做commit操作.
</code></pre><h3 id="事务的四大特性"><a href="#事务的四大特性" class="headerlink" title="事务的四大特性"></a>事务的四大特性</h3><p>事务的四大特性是事务本身具有的特点,简称ACID.</p>
<pre><code>*原子性(Atomicity).
原子性是指事务是一个不可分割的工作单位,事务中的操作要么都发生,要么都不发生.
*一致性(Consistency)
事务前后数据的完整性必须保持一致
*隔离性(Isolation)
事务的隔离性是指多个用户并发访问数据库时,一个用户的事务不能被其它用户的事务锁干扰,多个并发事务之间数据要相互隔离.
*持久性
持久性是指一个事务一旦被提交,它对数据库中数据的改变就是永久性的,接下来即使数据库发生故障也不应该对其有任何影响.    
</code></pre><h3 id="隔离性"><a href="#隔离性" class="headerlink" title="隔离性"></a>隔离性</h3><p>1.脏读:</p>
<pre><code>一个事务读取到另一个事务未提交的数据
---------------------------------
a    1000
b    1000
---------------------------------
a:
    start transaction;
    update account set money=money-100 where name=&apos;a&apos;;
    update account set money=money+100 where name=&apos;b&apos;;
----------------------------------------------------
b:
    start transaction;    
    select * from account;
    a    900
    b    1100
    commit;
------------------------------
a:
    rollback;
--------------------------------
b:
    select transaction;
    select * from account;
    a    1000
    b    1000
    commit;
</code></pre><p>2.不可重复读:<br>&nbsp;&nbsp;&nbsp;&nbsp;一个事务多次读取数据库中同一条记录,多次查询的结果不同(一个事务读取到另一个事务已经提交的数据)</p>
<pre><code>a    1000    1000    1000
-----------------------------
b:    start transaction;
    select 活期 from account where name = &apos;a&apos;;---活期存款:1000元
    select 定期 from account where name = &apos;a&apos;;---定期存款:1000元
    select 固定 from account where name = &apos;a&apos;;---固定资产:1000元
    ----------------------
    a:
        start transaction;
        update account set 活期=活期-1000 where name=&apos;a&apos;;
        commit;
        ------------------
    select 活期+定期+固定 from account where name=&apos;a&apos;;---总资产:2000元
</code></pre><p>3.虚读(幻读)<br>&nbsp;&nbsp;&nbsp;&nbsp;有可能出现,有可能不出现:一个事务多次查询整表数据,多次查询,由于有其他事务增删数据,造成的查询结果不同(一个事务读取到另一个事务已经提交的数据)</p>
<pre><code>a    1000
b    1000
--------------------------
d:
    start transaction;
    select sum(money) from account;---总存款3000元
    select count(*) from account;---总账户2个
    -----------------
    c:
        start transaction;
        insert into account values(&apos;c&apos;,3000);
        commit;
        ----------------
    select avg(mone) from account;---平均每个账户:2000元
</code></pre><h3 id="数据库的隔离级别"><a href="#数据库的隔离级别" class="headerlink" title="数据库的隔离级别"></a>数据库的隔离级别</h3><pre><code>数据库的四大隔离级别:
Read uncommitted;
---不做任何隔离,可能造成脏读 不能重复读 虚读(幻读)问题
Read Committed;
---可以防止脏读,但是不能防止不可重复读 虚读(幻读)问题
Repeatable Read;
---可以防止脏读 不可重复读,但是不能防止虚读(幻读)问题
Serializable;
---可以防止所有隔离性的问题,但是数据库就被设计为了串行化的数据库,性能很低
</code></pre><p>从安全性上考虑:</p>
<pre><code>Serializable &gt; Repeatable Read &gt; Read Committed &gt; Read uncommitted
</code></pre><p>从性能上考虑</p>
<pre><code>Read uncommitted &gt; Read committed &gt; Repeatable Read &gt;Serializable
</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;其中Serializable性能太低用的不多,Read uncommitted安全性太低用的也不多,我们通常从Repeatable Read和Read committed中选择一个.<br>&nbsp;&nbsp;&nbsp;&nbsp;如果需要防止不可重复读选择Repeatable Read,如果不需要防止选择Read committed<br>&nbsp;&nbsp;&nbsp;&nbsp;数据库默认的隔离级就是Repeatable Read<br>&nbsp;&nbsp;&nbsp;&nbsp;Oracle数据库默认的隔离级别是Read committed</p>
<h3 id="操作数据库的隔离级别"><a href="#操作数据库的隔离级别" class="headerlink" title="操作数据库的隔离级别"></a>操作数据库的隔离级别</h3><p>1.查询数据库的隔离级别:</p>
<pre><code>select @@tx_isolation;
</code></pre><p>2.修改数据库的隔离级别:</p>
<pre><code>set[session/global] transaction isolation level xxxx;
</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;不写默认是session,修改的是当前客户端和服务器交互时使用的隔离级别,并不会影响其他客户端的隔离级别<br>&nbsp;&nbsp;&nbsp;&nbsp;如果写成global,修改的是数据库默认的隔离级别(即新开客户端时,默认的隔离级别),并不会修改当前客户端和已经开启的客户端的隔离级别.</p>
<p>###数据库的锁  ###<br>1.共享锁<br>&nbsp;&nbsp;&nbsp;&nbsp;共享锁和共享锁可以共存,共享锁和排他锁不能共存,在非Serializable隔离级别下做查询不加任何锁, 在Serializable隔离级别下做查询加共享锁.<br>2.排他锁<br>&nbsp;&nbsp;&nbsp;&nbsp;排他锁和共享锁不能共存,排他锁和排他锁也不能共存,在任何隔离级别下做增删改都加排他锁.<br>3.死锁<br>&nbsp;&nbsp;&nbsp;&nbsp;当两边都是Serializable隔离级别时,两边都先进行查询,再尝试进行修改,则互相等待对方释放共享锁,都无法接着进行执行.<br>&nbsp;&nbsp;&nbsp;&nbsp;死锁的解决方法有两种办法:避免死锁,解决死锁.<br>&nbsp;&nbsp;&nbsp;&nbsp;mysql可以自动检测到死锁,错误退出一方执行另一方</p>
<h4 id="更新丢失问题"><a href="#更新丢失问题" class="headerlink" title="更新丢失问题"></a>更新丢失问题</h4><p>1.更新丢失问题的产生<br>&nbsp;&nbsp;&nbsp;&nbsp;两个并发的事务基于同一个查询结果进行修改,后提交的事务忽略了先提交的事务对数据库的影响,造成了先提交的事务对数据库的影响丢失,这个过程就叫做更新丢失.<br>2.更新丢失解决方案<br>&nbsp;&nbsp;&nbsp;&nbsp;将数据库设为Serializable隔离级别,但是我们一般不会将数据库设置为Serializable<br>&nbsp;&nbsp;&nbsp;&nbsp;在非Serializable下可以用乐观锁和悲观锁解决更新丢失.</p>
<pre><code>悲观锁:在查询时,手动的加排他锁,从而在查询时就排除可能的更新丢失.
乐观锁:在表中设计版本字段,在进行修改时,要求根据具体版本进行修改,并将版本字段+1,如果更新失败,说明更新丢失,需要重新进行更新.
总结:两种解决方案各有优缺点,如果查询多于修改用乐观锁,如果修改多于查询用悲观锁.
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/22/简单算法总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fireworks">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ghost">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/22/简单算法总结/" itemprop="url">简单算法总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-22T13:19:55+08:00">
                2018-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-冒泡排序"><a href="#1-冒泡排序" class="headerlink" title="1.冒泡排序"></a>1.冒泡排序</h4><p>冒泡排序的基本思想是:<br>&nbsp;&nbsp;&nbsp;&nbsp;1.比较相邻的元素,如果第一个比第二个大,就交换它们两个.<br>&nbsp;&nbsp;&nbsp;&nbsp;2.对每一对相邻元素作同样的工作,从开始第一对到结尾的最后一对,在这一点,最后的元素应该会是最大的数.<br>&nbsp;&nbsp;&nbsp;&nbsp;3.针对所有的元素重复以上的步骤,除了最后一个.<br>&nbsp;&nbsp;&nbsp;&nbsp;4.持续每次对越来越少的元素重复上面的步骤,直到没有任何一对数字需要比较.<br><strong>实现性能:</strong><br>1.最差时间复杂度O(n^2)<br>2.最优时间复杂度O(n)<br>3.平均时间复杂度O(n^2)<br>4.最差时间复杂度O(n),需要辅助空间O(1)<br>&nbsp;&nbsp;&nbsp;&nbsp;例如,如果需要将一组数(n个数)以从小到大的顺序排序,那么就可以设计这样的冒泡方法:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">//假设有5个数,总共比较4轮,</span><br><span class="line">//第一轮比较4次,第二轮比较3次,第三轮比较2次,第四轮比较1次</span><br><span class="line">public class BubbleSortDemo&#123;</span><br><span class="line">	static void bubbleSort(int[] arr)&#123;</span><br><span class="line">		for(int i = 0;i &lt; arr.length-1;i++)&#123;</span><br><span class="line">			for(int j = 0;j &lt; arr.length-1-i;j++)&#123;</span><br><span class="line">				if(arr[j]&gt;att[j+1])&#123;</span><br><span class="line">					int temp = arr[j];</span><br><span class="line">					arr[j] = arr[j+1];</span><br><span class="line">					arr[j+1] = temp;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">		int[] arr = new int[] &#123;1,2,5,7,12,4&#125;;</span><br><span class="line">		//printArray(arr);</span><br><span class="line">		bubbleSort(arr);</span><br><span class="line">		for(int a:arr) &#123;</span><br><span class="line">			System.out.print(a);</span><br><span class="line">		&#125;</span><br><span class="line">		//printArray(arr);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h4><p>选择排序算法,顾名思义就是直接从排序数组中选择一个最小(或最大的)数字.每次都拿一个最小数字出来,顺序放入新数组中,直到全部拿完.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public class ChoiceDemo&#123;</span><br><span class="line">	static void choice(int[] arr)&#123;</span><br><span class="line">		//每个数都要执行一次选择排序</span><br><span class="line">		for(int i = 0;i&lt;arr.length;i++)&#123;</span><br><span class="line">			//剩下的数组元素每个也要执行一次选择排序</span><br><span class="line">			for(int j = i+1;j&lt;arr.length;j++)&#123;</span><br><span class="line">				//按从小到大排序</span><br><span class="line">				int temp;</span><br><span class="line">				if(arr[i]&gt;arr[j])&#123;</span><br><span class="line">					temp = arr[i];</span><br><span class="line">					arr[i] = arr[j];</span><br><span class="line">					arr[j] = temp;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public staitc void main(String[] args)&#123;</span><br><span class="line">		int[] arr = new int[]&#123;1,12,34,5,8&#125;;</span><br><span class="line">		choice(arr);</span><br><span class="line">		for(int a:arr)&#123;</span><br><span class="line">			System.out.println(a);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h4><p>二分查找又称折半查找,假设表中元素是按升序排序,将表中间位置的元素与查找关键字比较,如果两者相等,则查找成功,否则利用中间位置记录将表分成前.后两个子表,如果中间位置的元素大于要查找的关键字,则进一步查找前一个子表,否则进一步查找后一个子表,重复以上过程,直到找到满足条件的记录,使查找成功,或直到子表不存在为止,此时查找不成功.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public class DichotomyDemo&#123;</span><br><span class="line">	static int foldFind(int[] arr,int key)&#123;</span><br><span class="line">		int min = 0;</span><br><span class="line">		int max = arr.length-1;</span><br><span class="line">		int mid = 0;</span><br><span class="line">		//必须判断min&lt;max</span><br><span class="line">		while(min&lt;max)&#123;</span><br><span class="line">			mid = (min_max)/2;</span><br><span class="line">			if(key&lt;arr[mid])&#123;</span><br><span class="line">				max = mid-1;</span><br><span class="line">			&#125;else if(key&gt;arr[mid])&#123;</span><br><span class="line">				min = mid+1;</span><br><span class="line">			&#125;else&#123;</span><br><span class="line">				return mid;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		return -1;</span><br><span class="line">	&#125;</span><br><span class="line">public static void main(String[] args)&#123;</span><br><span class="line">	int[] arr = new int[]&#123;1,2,3,4,5,6,7,8&#125;;</span><br><span class="line">	System.out.println(foldFind(arr,6));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/22/tomcat相关/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fireworks">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ghost">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/22/tomcat相关/" itemprop="url">tomcat相关</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-22T13:19:55+08:00">
                2018-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="tomcat的下载安装配置"><a href="#tomcat的下载安装配置" class="headerlink" title="tomcat的下载安装配置"></a>tomcat的下载安装配置</h3><p>1.下载tomcat<br>&nbsp;&nbsp;&nbsp;&nbsp;下载地址<a href="http://tomcat.apache.org" target="_blank" rel="noopener">http://tomcat.apache.org/</a><br>&nbsp;&nbsp;&nbsp;&nbsp;下载时请注意,不同版本的区别:<br>&nbsp;&nbsp;&nbsp;&nbsp;.zip为压缩版,解压后即可使用.<br>&nbsp;&nbsp;&nbsp;&nbsp;.exe为安装版,安装后使用.<br>2.安装tomcat<br>&nbsp;&nbsp;&nbsp;&nbsp;(1).解压<br>&nbsp;&nbsp;&nbsp;&nbsp;将解压版.zip包拷贝到要安装的目录下,解压,改名为tomcat7.0.<br>&nbsp;&nbsp;&nbsp;&nbsp;注意,安装目录中不允许有空格和中文<br>3.配置环境<br>tomcat是java写的,需要jdk支持,故要配置java环境 ,然后配置tomcat,此处值介绍如何配置tomcat环境<br>计算机 &gt; 属性 &gt; 高级系统设置 &gt; 环境变量 &gt; 新建 &gt; 变量名<br>变量名设为:TOMCAT_HOME,值为tomcat安装的根目录<br>4.启动tomcat<br>&nbsp;&nbsp;&nbsp;&nbsp;通过[tomcat]/bin/startup.bat文件 启动tomcat服务器<br>&nbsp;&nbsp;&nbsp;&nbsp;通过[tomcat]/bin/shutdown.bat文件 关闭tomcat服务器<br>&nbsp;&nbsp;&nbsp;&nbsp;浏览器访问在<a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a> 如果能够看到tomcat的首页就证明tomcat安装配置成功<br>5.安装常见问题<br>&nbsp;&nbsp;&nbsp;&nbsp;(1).端口占用问题:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.看是否一句你打开tomcat,或是tomcat在关闭时没有正确的关闭,可以运行shutdown.bat命令,然后再次打开.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.可以在cmd窗口中使用netstat -ano命令查询出哪个程序占用了端口,根据pid,在任务管理器的服务中找到此pid,结束这个程序后再启动tomcat即可.<br>&nbsp;&nbsp;&nbsp;&nbsp;(2).安装路径问题<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tomcat安装路径中一定不能有中文和空格,坑呢一时半会没问题,可能不知道什么时候可能出现意外.<br>6.修改默认的端口号<br>&nbsp;&nbsp;&nbsp;&nbsp;服务器在启动之后默认监听的是8080端口号,每次访问时都需要在IP地址或者主机名后面跟上这个端口号,如果想省略不写,可以将8080改为80即可.<br>&nbsp;&nbsp;&nbsp;&nbsp;找到[tomcat]/conf/server.xml文件并打开,第70行  </p>
<pre><code>&lt;Connection port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;
    connectionTimeout=&quot;20000&quot;
    redirectPort=&quot;8443&quot;/&gt;
---------------------------------
将其中的8080改为80即可      
</code></pre><h3 id="tomcat的目录结构"><a href="#tomcat的目录结构" class="headerlink" title="tomcat的目录结构"></a>tomcat的目录结构</h3><pre><code>bin---存放tomcat批处理文件的目录
conf---存放tomcat配置文件的目录
lib---存放tomcat运行时依赖的jar包
logs---存放tomcat运行时产生的日志文件的目录
temp---存放tomcat运行时产生的临时文件的目录
webapps---这是和开发人员关系最大的目录,是用来存放web应用的目录,我们开发的web资源要保存在这个目录下,外界就可以访问了.
work---存放tomcat服务器运行时产生的工作文件的目录
</code></pre><h3 id="部署web应用到虚拟主机中"><a href="#部署web应用到虚拟主机中" class="headerlink" title="部署web应用到虚拟主机中"></a>部署web应用到虚拟主机中</h3><p>1.方式一:(了解)<br>&nbsp;&nbsp;&nbsp;&nbsp;在[tomcat]/conf/server.xml中的<host></host>标签内部,添加一个Context标签,配置如下: </p>
<pre><code>&lt;Context path=&quot;/news&quot; docBase=&quot;C:\Users\hh\Desktop\news&quot;&gt;
</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;其中path属性指定WEB应用的虚拟路径,第一个斜杠可以省略,docBase用来指定WEB应用真实路径<br>&nbsp;&nbsp;&nbsp;&nbsp;可以在浏览器输入相应的虚拟路径网址访问资源,比如:<a href="http://localhost/news/regist/regist.html" target="_blank" rel="noopener">http://localhost/news/regist/regist.html</a><br>&nbsp;&nbsp;&nbsp;&nbsp;这种方式每次配置完后都需要重新启动服务器才可以生效,所以不推荐!!!<br>2.方式二:<br>&nbsp;&nbsp;&nbsp;&nbsp;在[tomcat]/conf/Catalina/host目录下添加一个xxx.xml文件,文件的名字就是WEB应用的虚拟路径,文件中添加内容如下:<br>&nbsp;&nbsp;&nbsp;&nbsp;比如:我们先创建news2文件夹,在[tomcat]/conf/Catalina/localhost目录下添加一个news2.xml文件,文件内容如下:  </p>
<pre><code>&lt;Context docBase=&quot;C:\Users\hh\Desktop\news2&quot;/&gt;
</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;这种方式配置后不需要重启服务器就可以起到作用!<br>3.方式三:<br>&nbsp;&nbsp;&nbsp;&nbsp;直接将WEB应用放在localhost主机默认管理的目录下即可!<br>&nbsp;&nbsp;&nbsp;&nbsp;这里localhost管理的目录是webapps目录,[tomcat]/conf/server.xml中第124行可以看到,当然也可以修改,一般都不要动  </p>
<pre><code>&lt;Host name=&quot;localhost&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;
</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;文件夹的名字成为web应用的虚拟路径,无须重启服务器<br>&nbsp;&nbsp;&nbsp;&nbsp;比如:创建news3,并放入[tomcat]/webapps中,即可访问</p>
<h3 id="配置缺省的WEB应用"><a href="#配置缺省的WEB应用" class="headerlink" title="配置缺省的WEB应用"></a>配置缺省的WEB应用</h3><p>1.第一种配置方式 只需要将path的值配置为空(“ “)即可<br>2.第二种配置方式 只需要将xxx.xml文件的名字配置为ROOT即可.<br>3.第三种配置 方式 只需要将webapps目录下WEB应用文件夹的名字配置为ROOT即可.<br>注意:如果三种方式都配置了缺省WEB应用,优先级规则是:第一种 &gt; 第二种 &gt; 第三种</p>
<h3 id="配置虚拟主机"><a href="#配置虚拟主机" class="headerlink" title="配置虚拟主机"></a>配置虚拟主机</h3><p>第一步:在[tomcat]/conf/server.xml文件的Engine标签内部添加一个Host标签,配置如下(同时在[tomcat]/目录下创建baidu文件夹,并放入一个web应用)      </p>
<pre><code>&lt;Host name=&quot;www.baidu.com&quot; appBase=&quot;baidu&quot;&gt;&lt;/Host&gt;  
</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;其中name是必须存在的属性,用来指定虚拟主机的名称.<br>&nbsp;&nbsp;&nbsp;&nbsp;appBase可选属性,用来指定虚拟主机默认管理的目录,如果没有配置该属性,表示当前主机没有默认管理的目录!<br>第二步:<br>&nbsp;&nbsp;&nbsp;&nbsp;配置完后,还需要在DNS服务器中配置主机名和IP地址的映射关系,但是DNS服务器一般不能修改,可以通过hosts文件进行模拟,在下面的路径C:\Windows\System32\drivers\etc中找到hosts文件.<br>&nbsp;&nbsp;&nbsp;&nbsp; 在最后一行加入配置:(IP和网址之间是Tab键)  </p>
<pre><code>127.0.0.1    www.baidu.com
</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;在浏览器输入路径,如:<a href="http://www.baidu.com/news3/1.html" target="_blank" rel="noopener">www.baidu.com/news3/1.html</a><br>&nbsp;&nbsp;&nbsp;&nbsp;注意:当可以上网的时候,很有可能你输入的网址不能生效,直接去访问百度去了,这时候需要清dns缓存,打开cmd窗口,输入ipconfig/flushns,浏览器清缓再次打开即可.</p>
<h3 id="配置默认虚拟主机"><a href="#配置默认虚拟主机" class="headerlink" title="配置默认虚拟主机"></a>配置默认虚拟主机</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;当使用IP访问服务器时,会访问哪台主机呢?<br>&nbsp;&nbsp;&nbsp;&nbsp;在[tomcat]/conf/server.xml文件的Engine标签上有一个属性defaultHost,可以通过此属性改变默认虚拟主机,比如(默认是localhost)  </p>
<pre><code>&lt;Engine name=&quot;Catalina&quot; defaultHost=&quot;www.baidu.com&quot;&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/22/Redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fireworks">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ghost">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/22/Redis/" itemprop="url">Redis</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-22T13:19:55+08:00">
                2018-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><p><strong>Redis的特性</strong>  </p>
<ul>
<li>速度快  </li>
<li>持久化  </li>
<li>多种数据结构  </li>
<li>支持多种编辑语言  </li>
<li>功能丰富  </li>
<li>简单  </li>
<li>主从复制  </li>
<li>高可用,分布式<br><strong>Redis典型应用场景</strong>   </li>
<li>缓存系统  </li>
<li>计数器  </li>
<li>消息队列系统  </li>
<li>排行榜  </li>
<li>社交网络  </li>
<li>实时系统<br><strong>Redis安装</strong><br>三种启动方式  </li>
</ul>
<ol>
<li>最简启动<br><code>redis-server</code><br>验证方法<br><code>ps -ef | grep redis</code><br><code>netstat -antpl | grep redis</code><br><code>redis-cli -h ip -p port ping</code>    </li>
<li>动态参数启动 redis<br><code>redis-server --port 8088</code>  </li>
<li>配置文件启动<br><code>redis-server configPath</code>  </li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/22/mysql练习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fireworks">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ghost">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/22/mysql练习/" itemprop="url">sql练习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-22T13:19:55+08:00">
                2018-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="sql练习"><a href="#sql练习" class="headerlink" title="sql练习"></a>sql练习</h3><p><strong>创建数据库</strong><br><code>create database dbexecise;</code><br><strong>切换到dbexecise数据库</strong><br><code>use dbexecise;</code><br><strong>创建部门表</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table dept(</span><br><span class="line">	#部门编号</span><br><span class="line">	deptno int primary key,	</span><br><span class="line">	#部门名称</span><br><span class="line">	deptname varchar(50),	</span><br><span class="line">	# 部门位置	</span><br><span class="line">	loc varchar(50)				</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p><strong>部门表插入语句</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `dept` VALUES (&apos;10&apos;, &apos;会计部&apos;, &apos;北京&apos;);  </span><br><span class="line">INSERT INTO `dept` VALUES (&apos;20&apos;, &apos;调查部&apos;, &apos;杭州&apos;);  </span><br><span class="line">INSERT INTO `dept` VALUES (&apos;30&apos;, &apos;销售部&apos;, &apos;上海&apos;);</span><br><span class="line">INSERT INTO `dept` VALUES (&apos;40&apos;, &apos;营销部&apos;, &apos;深圳&apos;);</span><br></pre></td></tr></table></figure></p>
<p><strong>创建员工表</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">create table emp(	</span><br><span class="line">	#员工编号			</span><br><span class="line">	empno int primary key,	</span><br><span class="line">	#员工姓名	 </span><br><span class="line">	empname varchar(50),</span><br><span class="line">	#职位		</span><br><span class="line">	job varchar(50),	</span><br><span class="line">	#直属上级	</span><br><span class="line">	mgr int,</span><br><span class="line">	#受雇日期					</span><br><span class="line">	hiredate date,		</span><br><span class="line">	#薪资		</span><br><span class="line">	sal int,	</span><br><span class="line">	#奖金				</span><br><span class="line">	comm int,</span><br><span class="line">    #所在部门编号</span><br><span class="line">	deptno int,	</span><br><span class="line">	#外键				 </span><br><span class="line">	foreign key(deptno) references dept(deptno)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p><strong>员工表插入数据</strong></p>
<pre><code>INSERT INTO `emp` VALUES (&apos;7369&apos;, &apos;张无忌&apos;, &apos;办事员&apos;, &apos;7902&apos;, &apos;1980-12-17&apos;, &apos;800&apos;, null, &apos;20&apos;);
INSERT INTO `emp` VALUES (&apos;7499&apos;, &apos;曹操&apos;, &apos;推销员&apos;, &apos;7698&apos;, &apos;1981-02-20&apos;, &apos;1600&apos;, &apos;300&apos;, &apos;30&apos;);
INSERT INTO `emp` VALUES (&apos;7521&apos;, &apos;杨志&apos;, &apos;推销员&apos;, &apos;7698&apos;, &apos;1981-02-22&apos;, &apos;1250&apos;, &apos;500&apos;, &apos;30&apos;);
INSERT INTO `emp` VALUES (&apos;7566&apos;, &apos;朱元璋&apos;, &apos;经理&apos;, &apos;7839&apos;, &apos;1981-04-02&apos;, &apos;2975&apos;, null, &apos;20&apos;);
INSERT INTO `emp` VALUES (&apos;7654&apos;, &apos;殷天正&apos;, &apos;推销员&apos;, &apos;7698&apos;, &apos;1981-09-28&apos;, &apos;1250&apos;, &apos;1400&apos;, &apos;30&apos;);
INSERT INTO `emp` VALUES (&apos;7698&apos;, &apos;张三丰&apos;, &apos;经理&apos;, &apos;7839&apos;, &apos;1981-05-01&apos;, &apos;2850&apos;, null, &apos;30&apos;);
INSERT INTO `emp` VALUES (&apos;7782&apos;, &apos;关羽&apos;, &apos;经理&apos;, &apos;7839&apos;, &apos;1981-06-09&apos;, &apos;2450&apos;, null, &apos;10&apos;);
INSERT INTO `emp` VALUES (&apos;7788&apos;, &apos;宋江&apos;, &apos;分析员&apos;, &apos;7566&apos;, &apos;1987-04-19&apos;, &apos;3000&apos;, null, &apos;20&apos;);
INSERT INTO `emp` VALUES (&apos;7839&apos;, &apos;韩少云&apos;, &apos;董事长&apos;, null, &apos;1981-11-17&apos;, &apos;5000&apos;, null, &apos;10&apos;);
INSERT INTO `emp` VALUES (&apos;7844&apos;, &apos;孙二娘&apos;, &apos;推销员&apos;, &apos;7698&apos;, &apos;1981-09-08&apos;, &apos;1500&apos;, &apos;0&apos;, &apos;30&apos;);
INSERT INTO `emp` VALUES (&apos;7876&apos;, &apos;张飞&apos;, &apos;办事员&apos;, &apos;7788&apos;, &apos;1987-05-23&apos;, &apos;1100&apos;, null, &apos;20&apos;);
INSERT INTO `emp` VALUES (&apos;7900&apos;, &apos;赵云&apos;, &apos;办事员&apos;, &apos;7698&apos;, &apos;1981-12-03&apos;, &apos;950&apos;, null, &apos;30&apos;);
INSERT INTO `emp` VALUES (&apos;7902&apos;, &apos;诸葛亮&apos;, &apos;分析员&apos;, &apos;7566&apos;, &apos;1981-12-03&apos;, &apos;3000&apos;, null, &apos;20&apos;);
INSERT INTO `emp` VALUES (&apos;7934&apos;, &apos;夏侯惇&apos;, &apos;办事员&apos;, &apos;7782&apos;, &apos;1982-01-23&apos;, &apos;1300&apos;, null, &apos;10&apos;);
</code></pre><p>###查询语句<br><strong>1.列出部门名称和这些部门的员工信息,同时列出那些没有员工的部门</strong><br><code>select deptname, empname, empno, emp.deptno from dept left join emp on emp.deptno=dept.deptno;</code><br><strong>2.列出薪资比关羽高的所有员工.</strong><br>1).查询出关羽的薪资<br><code>select sal from emp where empname=&#39;关羽&#39;</code><br>2).查询出比关羽薪资高的员工<br><code>select empno,empname,sal from emp where sal&gt;( SELECT sal from emp where empname=&#39;关羽&#39;);</code><br><strong>3.列出所有员工的姓名及其直接上级的姓名</strong><br>1).查询员工<br><code>select empno,mgr from emp e1;</code><br>2).查询员工的上级<br><code>select empno,empname from emp e2;</code><br>3).关联查询,查询出员工及员工对应的上级<br><code>select e1.empname,e2.empname from emp e1,emp e2 where e1.mgr = e2.empno;</code><br><strong>4.列出最低薪资大于1500的各种职位及其从事此职位的员工人数</strong><br>1).查询出各种职位的最低薪资<br><code>select job, min(sal) 最低薪资 from emp group by job having min(sal);</code><br>2).查询出最低薪资&gt;1500的职位<br><code>select job, min(sal) 最低薪资 from emp group by job having min(sal)&gt;1500;</code><br>3).查询出每个职位对应的员工人数<br><code>select job, min(sal) 最低薪资, count(*) 员工人数 from emp group by job having min(sal)&gt;1500;</code><br><strong>5.列出在销售部职位的员工姓名,假定不知道销售部的部门编号</strong><br>1).查询出销售部的部门编号<br><code>select deptno from dept where deptname=&#39;销售部&#39;;</code><br>2).查询出在销售部职位的员工姓名<br><code>select empname from emp where deptno=(select deptno from dept where deptname=&#39;销售部&#39;);</code><br><strong>6.列出与曹操从事相同职位的所有员工及部门名称</strong><br>1).查询出曹操从事的职位及部门编号<br><code>select job,deptno from emp where empname=&#39;曹操&#39;;</code><br>2).查询出与曹操从事相同职位的所有员工<br><code>select empname,deptno from emp where job=(select job from emp where empname=&#39;曹操&#39;);</code><br>3).查询出与曹操从事相同职位的所有员工及部门名称<br><code>select deptname,empname from dept,(select empname,deptno from emp  where job=(select job from emp where empname=&#39;曹操&#39;))e2 where dept.deptno=e2.deptno;</code><br><strong>7.列出薪资高于销售部(已知编号为30)就职的所有员工的薪资的员工姓名和薪资,部门名称</strong><br>1).查出在销售部就职的所有员工最高薪资<br><code>select max(sal) from emp where deptno=30;</code><br>2).关联查询, 查询员工的姓名,薪资, 部门名称<br><code>select e.empname,e.sal,d.deptname from emp e,dept d where e.deptno=d.deptno and sal&gt;(select max(sal) from emp where deptno=30);</code><br><strong>8.列出在每个部门职位的员工数量、平均工资。</strong><br><code>select count(*),avg(sal) from emp group by deptno;</code><br><strong>9.查出至少有一个员工的部门。显示部门人数、部门编号、部门名称、部门位置.</strong><br>1).查询出每个部门员工数量<br><code>select count(*),deptno from emp group by deptno;</code><br>2).关联查询,查询出部门编号、部门名称、部门位置<br><code>select i.c,d.deptname,d.loc,d.deptno from dept d,(select count(*) c,deptno from emp group by deptno)i  where i.deptno=d.deptno and i.c&gt;=1;</code><br><strong>10.列出受雇日期早于直接上级的所有员工的编号,姓名,部门名称</strong><br><code>select e1.empname, e1.empno, d.deptname from emp e1, emp e2, dept d where e1.deptno=d.deptno and e1.mgr=e2.empno and e1.hiredate &lt; e2.hiredate;</code><br><strong>11.列出所有职员的姓名及其部门名称，部门的人数。</strong><br><code>select t.empname, t.deptname, e.cnt 员工数量  from 
(
    select e.empname, e.deptno, d.deptname from emp e, dept d where e.deptno=d.deptno
) t, (
    select deptno, count(*) cnt from emp group by deptno
) e
where t.deptno = e.deptno;</code></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/22/MYSQL和Oracle的区别/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fireworks">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ghost">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/22/MYSQL和Oracle的区别/" itemprop="url">MYSQL和Oracle的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-22T13:19:55+08:00">
                2018-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h3><ul>
<li>Oracle为商用数据库,行业中占据相当的地位:市场占比2012年为40%.开发,管理资源相当丰富,有自己的matalink(有什么问题,都可以在那里得到较快的解决),一般项目中至少有两个Oracle数据库:联机事务处理(OLTP)数据库,联机分析处理数据库(OLAP),通过配置实现这两个数据库的同步,Oracle在这两个方面非常出色.  </li>
<li>Oracle具有良好的兼容性,可移植性,可连接性,高生产率,结构严谨,高可用,高性能使Oracle RDBMS具有良好的开放性.  </li>
<li>MYSQL为非商用开源数据库,免费,简便易用,中小型项目使用绝对没有问题,据说facebook这样的大型网站也用MYSQL做数据库.  </li>
<li>MYSQL更多的是追求轻量,易用,以及早期的事物操作及复杂查询优化的缺失,在传统的数据库应用场景中,份额极少.  </li>
<li>MYSQL最大的特点就是自由选择存储引擎,每个表都是一个文件,都可以选择合适的存储引擎.常见的引擎有InnoDB,MyISAM,NDBCluster等,但由于这种开放插件式的存储引擎,比如要求数据库与引擎之间的松耦合关系,从而导致文件的一致性大大降低,在SQL执行优化方面,也就有着一些不可避免的瓶颈,在多表关联,子查询优化,统计函数等方面是软肋,而且只支持极简单的HINI.  </li>
</ul>
<h3 id="MYSQL数据库特点"><a href="#MYSQL数据库特点" class="headerlink" title="MYSQL数据库特点"></a>MYSQL数据库特点</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;MYSQL作为一种开放源码数据库,以其简单易用的特点广泛被广大用户采用.<br>&nbsp;&nbsp;&nbsp;&nbsp;MYSQL虽然是免费的,但同Oracle,Sysbase,Informix,Db2等商业数据库一样,具有数据库系统的通用性:  </p>
<ul>
<li>数据库管理系统.所谓的数据库就是一些结构化的数据的联合体,要提供对这些数据的存取,增加,修改,删除或更加复杂的数据抽取等操作,需要有一个支撑系统,这就是数据库管理系统(DBMS),MYSQL完全具有这方面的功能.  </li>
<li>关系型数据库管理系统.在数据库的发展历程中,曾出现过多种不同形式的数据库系统,但关系型数据库管理系统(DBMS)以其优越性而被广为采用,现在几种广泛使用的数据库全为关系型数据库,同样,MYSQL也是关系型数据库,支持标准的结构化查询语言.  </li>
<li>开放源码数据库.同商业性的数据库相比,这是MYSQL最大的特点.MYSQL的源码是公开的,这就意味着任何人,只要遵守GPL的规则都可以对MYSQL的源码使用,修改以符合自己特殊的要求.  </li>
<li>技术特点.MYSQL是C/S架构的服务器,服务器端是多线程的,为客户端提供了不同的程序接口和链接库,如C,C++,java,PHP,Tcl等,也提供了简单的管理工具,如mysql,mysqlmin等.  </li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;MYSQL的特性:  </p>
<ul>
<li>开发语言是C/C++,支持多种编译器,如gcc,cc,xlc,acc等.  </li>
<li>良好的内存管理机制,尤其是内存泄漏问题的管理,通过了Pueify的严格测试.  </li>
<li>支持多种平台,如AIX,Solaris,HP,FreeBSD,Windows等.  </li>
<li>提供多种形式的API,为我们开发工具的选择提供了便利.  </li>
<li>使用多线程的技术,可充分发挥系统的特点,避免在SMP系统中出现仅使用但CPU的现象.  </li>
<li>对磁盘表的管理采用Btree加密及索引的技术,为我们快速访问数据提供了可能.  </li>
<li>高性能的内存申请技术  </li>
<li>临时表采用在内存中以哈希表实现  </li>
<li>提供多种数据类型  </li>
<li>支持定长和变长的记录  </li>
<li>所有的列都有缺省值,为我们的某些’粗心’提供了方便  </li>
<li>灵活,安全的权限和密码系统,密码在传输中加密传输,允许主机端验证密码  </li>
<li>客户端可以通过TCP/IP,Unix套接字,命令管道(NT)连接到MYSQL数据库服务器  </li>
<li>对多种字符集的完全支持  </li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/22/mysql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fireworks">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ghost">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/22/mysql/" itemprop="url">mysql</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-22T13:19:55+08:00">
                2018-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><h3 id="什么是数据库"><a href="#什么是数据库" class="headerlink" title="什么是数据库"></a>什么是数据库</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;数据库(Database)是按照数据结构来组织、存储和管理数据的仓库，简而言之就是存储数据的仓库。  </p>
<h3 id="数据库的分类"><a href="#数据库的分类" class="headerlink" title="数据库的分类"></a>数据库的分类</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;层次式数据库，网络式数据库，关系型数据库<br>&nbsp;&nbsp;&nbsp;&nbsp;数据库可以按照一定的数据结构存储管理大量的数据及数据与数据之间的关系，它本质上是一种信息管理系统。它本质上是一种信息管理系统，数据库根据存储采用的数据结构的不同可以分为许多种，其中常见的有层次式数据库，网络式数据库，关系型数据库，其中关系型数据库占据着市场的主流.  </p>
<h3 id="关系型数据库"><a href="#关系型数据库" class="headerlink" title="关系型数据库"></a>关系型数据库</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;关系型数据库是建立在关系模型<br>  基础上的数据库.这种定义听起来十分抽象,这里只是简单的表述为利用表来存储数据,用表和表之间的关系保存数据之间的关系的数据库称为关系型数据库.(这个定义不太严谨,但是更好理解).  </p>
<pre><code>常见的关系型数据库: 
    SqlServer  
    Oracle  
    MySql  
    DB2  
    ...
</code></pre><h3 id="MySql数据库的安装与配置"><a href="#MySql数据库的安装与配置" class="headerlink" title="MySql数据库的安装与配置"></a>MySql数据库的安装与配置</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;mysql下载地址:<a href="https://www.mysql.com/downloads/" target="_blank" rel="noopener">https://www.mysql.com/downloads/</a>,安装和配置步骤详见mysql安装文档.<br>&nbsp;&nbsp;&nbsp;&nbsp;注意:mysql安装的路径不要有中文和空格<br>&nbsp;&nbsp;&nbsp;&nbsp;默认的端口3306不要修改,保持默认即可</p>
<h3 id="MySql相关命令"><a href="#MySql相关命令" class="headerlink" title="MySql相关命令"></a>MySql相关命令</h3><pre><code>登录mysql客户端命令:mysql -uroot -proot -h localhost;
    -u:后面的root是用户名,这里使用的是超级管理员root;
    -p:后面的root是密码,这里在安装MySql时就一句你个指定的密码;
    -h:后面给出的localhost是服务器主机名,它是可以省略的,例如 mysql -uroot -proot;
退出客户端命令:quit或exit;
扩展:通过命令启动、停止、删除服务（在C:\Windows\System32下以管理员运行cmd.exe）
    启动:net start 服务名称
    关闭:net stop 服务名称
    删除:sc delete 服务名称
    (如果服务名称中间有空格,就需要前后加引号)
如果C:\Users\hh\mysql
    &apos;mysql&apos;不是内部或外部命令,也不是可运行的程序或批处理文件
则表示没有配置mysql的bin目录到path环境变量中!!!
</code></pre><h3 id="MySql常见的概念"><a href="#MySql常见的概念" class="headerlink" title="MySql常见的概念"></a>MySql常见的概念</h3><pre><code>数据库服务器:安装的mysql软件就是mysql服务器.
数据库:是数据库表的集合,数据库服务器中可以创建多个数据库.
表:类似于一个excel表格,用于存储数据
表记录:即表中的一行数据
</code></pre><h1 id="SQL语言"><a href="#SQL语言" class="headerlink" title="SQL语言"></a>SQL语言</h1><h3 id="SQL概述"><a href="#SQL概述" class="headerlink" title="SQL概述"></a>SQL概述</h3><pre><code>SQL,指结构化查询语言,全程是Structured QueryLanguage
SQL是操作关系型数据库通用的语言
SQL是非过程性语言
SQL是一个标准,各大数据库厂商都根据该标准提供了实现.
数据库厂商为了增强数据库的功能,添加了一些非标准的SQL,称之为数据库的&quot;方言&quot;.
</code></pre><h1 id="利用sql语句来操作数据库"><a href="#利用sql语句来操作数据库" class="headerlink" title="利用sql语句来操作数据库"></a>利用sql语句来操作数据库</h1><h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><pre><code>语法:
CREATE DATABASE [IF NOT EXISTS] db_name [CHARACTER SET charset_name][COLLATE collation_name]
其中charset_name是为数据库指定的默认字符集
Collate是为数据库指定的默认校对规则
(校对规则是字符集内用于比较字符的一套规则,可以控制select 查询时 where 条件大小写是否敏感的规则)
练习:
~创建一个名称为mydb1的数据库.
    create database mydb1;
~创建一个使用gbk字符集的mydb2数据库
    create database mydb2 character set gbk;
</code></pre><h3 id="查看数据库"><a href="#查看数据库" class="headerlink" title="查看数据库"></a>查看数据库</h3><pre><code>语法:
    显示所有数据库:
        SHOW DATABASES
    显示数据库创建语句:
        SHOW CREATE DATABASE db_name
练习:
    ~查看当前数据库服务器中的所有数据库
        SHOW DATABASES;
    ~查看前面创建的mydb2数据库的定义信息
        SHOW CREATEBASE mydb2;
</code></pre><h3 id="修改数据库"><a href="#修改数据库" class="headerlink" title="修改数据库"></a>修改数据库</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;注意:数据库一旦创建成功,其名字无法修改! </p>
<pre><code>语法:
    ALTER DATABASE db_name [CHARCHTER SET charset_name][COLLATE collation_name]
练习:
~查看服务器中的数据库,并把mydb2库的字符集修改为utf8
    alter database mydb2 character set utf8;
</code></pre><h3 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h3><pre><code>语法:DROP DATABASE [IF EXISTS] db_name
练习:
~删除前面创建的mydb2数据库
    DROP DATABASE mydb2;
</code></pre><h3 id="选择数据库"><a href="#选择数据库" class="headerlink" title="选择数据库"></a>选择数据库</h3><pre><code>语法:
    选择数据库:use db_name;
    查询当前选择的数据:select database();
    (没有退出数据库的命令,如果想退出当前数据库进入另一个数据,直接use 切换到另一个数据库就可以了)    
</code></pre><h1 id="利用sql语句来操作数据库表"><a href="#利用sql语句来操作数据库表" class="headerlink" title="利用sql语句来操作数据库表"></a>利用sql语句来操作数据库表</h1><h3 id="MySql中常见的数据类型"><a href="#MySql中常见的数据类型" class="headerlink" title="MySql中常见的数据类型"></a>MySql中常见的数据类型</h3><p>1.字符串类型</p>
<pre><code>char(n)定长字符串
n的最大值为255,表示存储255个字符
    例如:stuid char(10)
一般用于长度固定的字符串,比如手机号、身份证号，效率高
varchar(n)不定长字符串
n的最大值为65535个字节(5.0以后的版本)
例如:username varchar(50)
一般用于长度不固定的字符串,比如用户名、昵称等，节省空间
</code></pre><h3 id="数值类型"><a href="#数值类型" class="headerlink" title="数值类型"></a>数值类型</h3><pre><code>TINYINT:占用1个字节,相对于java中的byte
SMALLINT:占用2个字节,相对于java中的short
INT:占用4个字节,相对于java中的int
BIGINT:占用8个字节,相对于java中的long
FLOAT:4字节单精度浮点类型,相对于java中的float
DOUBLE:8个字节双精度浮点类型,相对于java中的double
</code></pre><h3 id="大数据类型"><a href="#大数据类型" class="headerlink" title="大数据类型"></a>大数据类型</h3><pre><code>BLOB:
大二进制类型,可以存入二进制类型的数据,通过这个字段,可以将图片、音频、视频等数据以二进制的形式存入数据库。最大为4GB.
TEXT:
大文本,被声明为这种类型的字段,可以保存大量的字符数据,最大为4GB.
注意:text属于mysql的方言,在其他数据库中为clob类型
</code></pre><h3 id="日期类型"><a href="#日期类型" class="headerlink" title="日期类型"></a>日期类型</h3><pre><code>DATE:日期2015-11-05
TIME:时间格式&apos;HH:MM:SS&apos; 19:19:19
DATETIME:日期时间 2015-11-05 19:19:19 年份范围:
TIMESTAMP:时间戳 2015-11-05 19:19:19 年份范围:
</code></pre><h3 id="逻辑型"><a href="#逻辑型" class="headerlink" title="逻辑型"></a>逻辑型</h3><pre><code>BIT型字段只能取两个值:0或1.
</code></pre><h3 id="字段的约束"><a href="#字段的约束" class="headerlink" title="字段的约束"></a>字段的约束</h3><pre><code>主键约束:保证所约束列中的值必须唯一且不能为空.
    添加主键约束(创建表时):col_name datatype primary key
    或(表已存在):Alter table tabname add primary key(col_name)
    设置主键自动增长:col_name datatype primary key auto_increment
唯一约束:unique 保证所约束列的值必须唯一,即不能重复.
非空约束: not null 保证所约束列的值不能为空
外键约束
</code></pre><h3 id="新增表语法"><a href="#新增表语法" class="headerlink" title="新增表语法:"></a>新增表语法:</h3><pre><code>create table table_name(
    field1 datatype,
    field2 datatype,
    field3 datatype
)[character set 字符集][collate 校对规则];
field:指定列名   datatype:指定列类型
注意:创建表时,要根据需保存的数据创建相应的列,并根据数据的类型定义相应的列类型.
创建表时,一般不需要指定字符集编码和校对规则,和数据库保持一致即可.

练习:
~创建employee表,表中字段信息如下:
字段                 属性
id                    整型
name                字符型
gender                字符型
birthday            日期型
entry_date            日期型
job                    字符型
salary                小数型
resume                大文本型
</code></pre><p>建表语句1:</p>
<pre><code>create table employee(
    id int,
    name varchar(50),
    gender char(1),
    birthday date,
    entry_date date,
    job varchar(50),
    salary double,
    resume text
);
</code></pre><h3 id="查看表"><a href="#查看表" class="headerlink" title="查看表"></a>查看表</h3><p>语法:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;查看表结构:<code>desc     tabName</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;查看当前所有表:<code>show tables</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;查看当前数据库表建表语句:<code>show create table tabName</code>  </p>
<h3 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h3><p>语法:<br>1.增加列:  </p>
<pre><code>table tabname add col_name datatype [default expr][add col_name datatype...]
练习:在上面员工表的基础上增加一个image列
alter table employee add image bolb;
</code></pre><p>2.修改列:  </p>
<pre><code>alter table tabname modify (col_name datatype     [default expr][,modify col_name datatype]...)
练习:修改job列,使其长度为60.
alter table employee modify job varchar(60);
</code></pre><p>3.删除列:</p>
<pre><code>alter table tabname drop [column] col_name; 
练习:删除gender列.
alter table employee drop gender;
</code></pre><p>4.修改表名:  </p>
<pre><code>alter table old_tabname rename to new_tabname
或
rename table new_tabname to old_tabname;
练习:表明改为user.
alter table employee rename to user;
或
rename table user to employee;     
</code></pre><p>5.修改列名称:</p>
<pre><code>alter table tabname change [column] old_col_name new_col_name datatype 
练习:修改列名称:
alter table employee change name username varchar(100);
</code></pre><p>6.修改列的顺序</p>
<pre><code>alter table tabname modify col_name1 datatype after col_name2;
练习:将image插入到id列的后面
alter table employee modify image blob after id;
</code></pre><p>7.修改表的字符集</p>
<pre><code>alter table tabname character set character_name;
练习:修改表的字符集为gbk
alter table employee character set gbk;
</code></pre><h3 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">语法:drop table tabname;</span><br><span class="line">练习:~删除employee表</span><br><span class="line">drop table user;</span><br></pre></td></tr></table></figure>
<h1 id="利用sql语句来操作数据库表记录"><a href="#利用sql语句来操作数据库表记录" class="headerlink" title="利用sql语句来操作数据库表记录"></a>利用sql语句来操作数据库表记录</h1><h3 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h3><p>语法:<code>insert into tabname[(column[,column...])] values (value[,value...])</code><br>注意:<br>&nbsp;&nbsp;&nbsp;&nbsp;插入的数据应与字段的数据类型相同<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;例如:name列对应的值为字符串,插入的数据类型也应该 是字符串类型!<br>&nbsp;&nbsp;&nbsp;&nbsp;数据的大小应在列的规定范围之内<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;例如:name列字符串长度为10,那么插入的数据长度不能超过10!<br>&nbsp;&nbsp;&nbsp;&nbsp;在values中列出的数据位置必须与被对应列的排列位置相对应<br>&nbsp;&nbsp;&nbsp;&nbsp;字符串和日期格式的数据要用单引号引起来<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;例如:’张飞’,’2017-6-1’<br>&nbsp;&nbsp;&nbsp;&nbsp;如果要插入所有字段可以省写列列表,直接按表中字段声明的顺序写值列表.<br>练习:<br>~向员工表中插入三条数据<br>&nbsp;&nbsp;&nbsp;&nbsp;注意:编码格式不同时,set name gbk;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">insert into employee(id,name,gender,birthday,entry_date,job,salary,resume) values(null,&apos;刘备&apos;,&apos;男&apos;,&apos;1876-1-1&apos;,&apos;1923-3-4&apos;,&apos;CEO&apos;,10000,&apos;很牛!!!&apos;);</span><br><span class="line">insert into employee values(null,&apos;张飞&apos;,&apos;男&apos;,&apos;1832-4-3&apos;,&apos;1934-2-3&apos;,&apos;大数据工程师&apos;,23333,&apos;还行吧!&apos;);</span><br><span class="line">insert into employee values(null,&apos;小乔,&apos;女&apos;,&apos;&apos;643-2-1&apos;,&apos;1923-2-2&apos;,&apos;&apos;前端开发工程师);</span><br></pre></td></tr></table></figure></p>
<p>在mysql中插入中文数据,或查询中文数据时的乱码问题:<br>&nbsp;&nbsp;&nbsp;&nbsp;乱码问题:客户端发送的数据是gbk,而服务器使用的utf-8的编码来处理客户端发来的数据,两端使用的编码不一致导致乱码.<br>&nbsp;&nbsp;&nbsp;&nbsp;解决方法1:在客户端可以通过set names gbk;通知服务器使用指定码表来处理客户端发送的数据,这种方式只对当前cmd命令窗口有效,每次新开的窗口都要设置一次.<br>&nbsp;&nbsp;&nbsp;&nbsp;解决方法2:可以通过修改mysql安装目录下的my.ini文件(57行)中的配置,来指定服务器端使用的码表,这种方式一劳永逸(注意配置完成后需要重启服务器!!);<br>&nbsp;&nbsp;&nbsp;&nbsp;查询数据库中的编码:show variables like ‘char%’;</p>
<h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><p>语法:<code>update tab_name set col_name1=erpr1[,col_name=expr2...][where where_definition]</code><br>&nbsp;&nbsp;&nbsp;&nbsp;update语法可以用新增值更新原有表行中的各列.<br>&nbsp;&nbsp;&nbsp;&nbsp;set子句指示要修改哪些列和要给予哪些值.<br>&nbsp;&nbsp;&nbsp;&nbsp;where子句指定应更新哪些行,如没有where子句,则更新所有的行.<br>练习:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~将所有员工薪水修改为3000元.</span><br><span class="line">  update employee set salary=3000;</span><br><span class="line">~将姓名为&apos;貂蝉&apos;的员工薪水修改为11000元.</span><br><span class="line">  update employee set salary=11000 where name=&apos;貂蝉&apos;;</span><br><span class="line">~将张飞的薪水在原有基础上增加1000元.</span><br><span class="line">  update employee set salary=salary+1000 where name=&apos;张飞&apos;;</span><br></pre></td></tr></table></figure></p>
<h3 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h3><p>语法:<code>delete from tab_name[where where_definition]</code><br>&nbsp;&nbsp;&nbsp;&nbsp;where用来筛选要删除的记录,如果不使用where子句,将删除表中所有数据.<br>&nbsp;&nbsp;&nbsp;&nbsp;delete语句不能删除某一列的值.<br>&nbsp;&nbsp;&nbsp;&nbsp;drop delete语句仅删除记录,不删除表本身,如要删除表,使用drop table语句.<br>练习:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~删除表中名称为&apos;张飞&apos;的记录.</span><br><span class="line">  delete from employee where name=&apos;张飞&apos;;</span><br><span class="line">~删除表中所有的记录.</span><br><span class="line">	delete from employee;</span><br></pre></td></tr></table></figure></p>
<h3 id="select"><a href="#select" class="headerlink" title="select"></a>select</h3><h4 id="基本查询"><a href="#基本查询" class="headerlink" title="基本查询"></a>基本查询</h4><p>语法:<code>select [destinct] * | {column1,column2,column3..} from table_name;</code><br>&nbsp;&nbsp;&nbsp;&nbsp;select指定查询哪些列的数据.<br>&nbsp;&nbsp;&nbsp;&nbsp;column指定列名.<br>&nbsp;&nbsp;&nbsp;&nbsp;*号代表查询所有列.<br>&nbsp;&nbsp;&nbsp;&nbsp;from 指定查询哪张表.<br>&nbsp;&nbsp;&nbsp;&nbsp;distinct可选,指显示结果时,是否剔除重复数据.<br>练习:</p>
<p>~执行下面的sql语句,创建exam表并插入数据</p>
<pre><code>create table exam(
    id int primary key auto_increment,
    naem varchar(20) not null,
    chinese double,
    math double,
    english double
);
</code></pre><p>~查询表中所有学生的信息.<br>  <code>select * from exam;</code><br>~查询表中所有学生的姓名和对应的语文成绩.<br> <code>select name,chinese from exam;</code><br>~过滤表中语文成绩重复数据.<br>  <code>select distinct chinese from exam;</code><br>~在所有想和省分数上加10分特长分显示.<br>  <code>select name,chinese+10,math+10,english+10 from exam;</code><br> 或者<br>  <code>select name,chinese+10 as 语文,math+10 as 数学, english+10 英语 from exam;</code></p>
<p>  ###通过as关键字指定别名,as可以省略不写.<br>~统计每个学生的总分(ifnull(colname,0))<br>  <code>select name,chinese+math+english 总分 from exam;</code><br>  <code>select name,chinese+math+ifnull(english,0)总分 from exam;</code></p>
<h3 id="使用where子句的查询"><a href="#使用where子句的查询" class="headerlink" title="使用where子句的查询"></a>使用where子句的查询</h3><p>语法:<code>select *|列名 from tablename[where where_definition]</code></p>
<p>练习:</p>
<p>~查询姓名为关羽的学生成绩<br>  <code>select * from exam where name=&#39;关羽&#39;;</code><br>~查询英语成绩大于90分的同学<br>  <code>select * from exam where english&gt;90;</code><br>~查询总分大于230分的所有同学<br>  <code>select name,chinese+math+ifnull(english,0)总分 from exam where chinese+math+ifnull(english,0)&gt;230;</code></p>
<p>  ###在where子句中不能使用列别名!!!<br>~查询语文分数在80~100之间的同学.<br>  <code>select * from exam where chinese&gt;80 and chinese&lt;100;</code><br> 或<br>  <code>select * from exam where chinese between 80 and 100;</code><br>~查询数学分数为75,76,77的同学,再查询分数不在这个范围内的同学.<br>  <code>select * from exam where math=75 or math=76 or math=77;</code><br>  <code>select * from exam where !(math=75 or math=76 or math=77);</code><br>  <code>select 8 from exam where not(math=75 or math=76 or math=77);</code><br> 或者<br>  <code>select * from exam where math in(75,76,77);</code><br> <code>select * from exam where math not in(75,76,77);</code><br>~查询数学分&gt;70,语文分&gt;80的同学.<br>  <code>select * from exam where math&gt;70 and chinese&gt;80;</code><br>~查询所有姓张的学生成绩<br>  <code>select * from exam where name like &#39;张%&#39;;</code><br>  like:模糊查询<br>  百分号(%):匹配0个或者多个字符,下划线(_):匹配一个字符<br>  例子:<br>    ‘200%’:找出任何以200开头的值<br>    ‘%200%’:找出任何存在200的值<br>    ‘<em>00%’:找出任何第二个位置和第三个位置为0的值<br>    ‘2</em>%_%’:找出任何以2开头,并且长度至少为3的值.<br>    ‘%2’:找出任何以2结尾的值.<br>    ‘_2%3’:找出任何第二个位置为2,并且以3结尾的值<br>    ‘2___3’:找出任何以2开始,以3结束的5位数</p>
<h3 id="排序查询"><a href="#排序查询" class="headerlink" title="排序查询"></a>排序查询</h3><p>语法:<code>select column1,column2,column3.. from tablename order by column asc|desc</code><br>&nbsp;&nbsp;&nbsp;&nbsp; order by指定排序的列,排序的列即可是表中的列名,也可以是select语句后指定的列名.<br>&nbsp;&nbsp;&nbsp;&nbsp;Asc升序(默认),Desc降序<br>&nbsp;&nbsp;&nbsp;&nbsp;order by 子句位于select语句的结尾.</p>
<p>练习:</p>
<p>~对数学成绩排序后输出(默认是升序)<br>  <code>select math from exam order by math;</code><br>~对总分排序按从高到低的顺序输出<br>  <code>select name,chinese+math+ifnull(english,0)总分 from exam order by 总分 desc;</code><br>~对姓张的学生总分排序输出<br>  <code>select name,chinese+math+ifnull(english,0)总分 from exam where name like &#39;张%&#39; order by 总分;</code></p>
<h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><p>语法:<br>1.求符合条件的记录中指定列的记录数<br><code>select count(列名)... from tabname[where where_definition]</code><br>2.求符合条件的记录中指定列的和值<br><code>select sum(列名)...from tablename[where where_difinition]</code><br>3.求符合条件的记录中指定列的平均值<br><code>select avg(列名)...from tablename[where where_difinition]</code><br>4.求符合条件的记录中指定列的最大值<br><code>select max(列名)...from tablename[where where_difinition]</code><br>5.求符合条件的记录中指定列的最小值<br><code>select min(列名)...from tablename[where where_difinition]</code><br>练习:</p>
<p>~统计一个班级共有多少学生?<br>  <code>select count(*) from exam;</code><br>~统计数学成绩大于75的学生有多少个?<br>  <code>select count(*) from exam where math&gt;75;</code><br>~统计总分大于230的人数有多少?<br>  <code>select count(*) from exam where chinese+math+ifnull(english,0)&gt;230;</code><br>~统计一个班级数学总成绩?<br>  <code>select sum(math)数学总成绩 from exam;</code><br>~统计一个班级语文,英语,数学三科成绩的总和<br>  <code>select sum(chinese)+sum(math)+sum(ifnull(english,0))总成绩 from exam;</code><br> 或<br> <code>select sum(chinese+math+ifnull(english,0))总成绩 from exam;</code><br>~ 统计一个班级英语成绩平均分<br>  <code>select  avg(english) from exam;</code><br>~求一个班级总分平均分?<br>  <code>select avg(chinese+math+ifnull(english,0)) from exam;</code><br>~求班级总分最高分和最低分<br>  <code>select max(chinese+math+ifnull(english,0)) from exam;</code><br>  <code>select min(chinese+math+ifnull(english,0)) from exam;</code></p>
<h3 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h3><p>语法:<br><code>select column1,column2,column3...from tablename group by column hving...</code><br>练习:<br>执行下面的SQL,创建orders表并插入数据</p>
<pre><code>create table orders(
id int,
product varchar(20),
price float
);
insert into orders(id,product,price)values(1,&apos;小米手机&apos;,900);
insert into orders(id,product,price)values(2,&apos;奥妙洗衣液&apos;,60);
insert into orders(id,product,price)values(3,&apos;乐视TV&apos;,90);
insert into orders values(4,&apos;联想键盘&apos;,80);
insert into orders values(5,&apos;奥妙洗衣液&apos;,60);
insert into orders values(6,&apos;小米手机&apos;,900);
</code></pre><p>~对订单表中商品归类后,显示每一类商品的总价</p>
<pre><code>select * from orders group by product;
select count(*) from orders group by product;
select sum(price) from orders group by product;
</code></pre><p>~查询购买了几类商品,并且每类总价大于100的商品<br><code>select product,sum(price) 总价 form orders group by product having sum(price)&gt;100</code><br>~查询单价小于100而总价大于100的商品的名称<br><code>select * from orders where price&lt;100 group by product having sum(price)&gt;100</code><br>where和having的区别?<br>&nbsp;&nbsp;&nbsp;&nbsp;where子句和having子句都可以进行过滤,但是使用场景有所不同:<br>&nbsp;&nbsp;&nbsp;&nbsp;where子句对分组之前的数据进行过滤,不能使用聚合函数和列别名<br>&nbsp;&nbsp;&nbsp;&nbsp;having子句对分组之后的数据进行过滤,可以使用聚合函数和别名<br>&nbsp;&nbsp;&nbsp;&nbsp;使用where子句的地方一般都可以用having替换,但是使用having的地方一般不能用where替代</p>
<h1 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h1><p>&nbsp;&nbsp;&nbsp;&nbsp;外键:唯一标识其他表中的一条记录,用来通知数据库两张表字段之间的对应关系,并让数据库帮我们维护这样关系的键就叫做外键.<br>&nbsp;&nbsp;&nbsp;&nbsp;外键作用:确保数据库数据的完整性和一致性.<br>添加    外键:例如:<code>foreign key(dept_id) references dept(id)</code><br>案例:</p>
<pre><code>create table dept(
id int primary key auto_increment,
name varchar(20)
);
insert into dept values(null,&apos;财务部&apos;);
insert into dept values(null,&apos;人事部&apos;);
insert into dept values(null,&apos;科技部&apos;);
insert into dept values(null,&apos;销售部&apos;);
create table emp(
id int primary key auto_increment,
name varchar(20),
dept_id int,
foreign key(dept_id) references dept(id)
);
</code></pre><h1 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h1><p>案例:</p>
<pre><code>create table emp(
id int primary key auto_increment,
name varchar(20),
dept_id int
);
insert into emp values(null,&apos;张三&apos;,1);
insert into emp values(null,&apos;李四&apos;,2);
insert into emp values(null,&apos;老王&apos;,3);
insert into emp values(null,&apos;刘能&apos;,5);
</code></pre><p>1.需求1:查询出部门表和员工表,同时列出部门信息和员工信息.</p>
<p><code>select * from dept,emp;</code>(笛卡尔积查询)<br><code>select * from dept,emp where emp.dept_id=dept.id;</code><br>或者<br><code>select * from dept inner join emp on dept_id=dept.id;</code></p>
<p>2.需求2:查询出部门信息和部门所对应的员工信息,同时列出那些没有员工的部门<br><code>select * from dept left join emp on dept_id=dept.id;</code><br>3.需求3:查询出部门信息和部门所对应的员工信息,同时列出那些没有部门<br>的员工<br><code>select * from dept right join emp on dept_id=dept.id;</code><br>4.需求3:查询出部门信息和部门所对应的员工信息,同时列出那些没有部门<br>的员工和那些没有员工的部门</p>
<p><code>select * from dept full join emp on dept_id=dept.id;</code></p>
<p>#mysql不支持</p>
<h3 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;两张表相乘得出来的结果,如果左边有m条记录,右边有n调记录,则查询出来的结果就是m*n条,这些查询结果中包含大量错误的结果,通常不会使用这种查询.</p>
<ol>
<li>内连接查询:查询出左右表(dept)有且右边表(emp)也有的记录.<br><code>select * from dept inner join emp on dept_id=dept.id;</code><br>2.左外连接查询:在内连接查询的基础上,加上左边表有而右边表没有的记录<br><code>select * from dept left join emp on dept_id=dept.id;</code><br>3.右外连接查询:在内部连接查询的基础上,加上右边表有而左边表没有的记录.<br><code>select * from dept right join emp on dept_id=dept.id</code><br>4.全外连接查询:在内连接查询的基础上,加上左边表有而右边表没有的记录和右边表有而左边表没有的记录.<br><code>select * from dept full join emp on dept.id=dept_id;</code><br>#mysql不支持全外连接查询<br>使用union模拟全外连接查询:<br><code>select * from dept left join emp on dept.id=dept_id
union
select * from dept right join emp on dept.id=dept_id;</code></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">fireworks</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fireworks</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
